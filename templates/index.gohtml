<!DOCTYPE HTML>
<html>
   <head>
        <title>EVE</title>
        <link rel="stylesheet" href="/static/style.css">
		<link href='http://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
        <script type="text/javascript" src="/static/ws.js"></script>
		<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="blur-svg">
			<defs>
				<filter id="blur-filter">
					<feGaussianBlur stdDeviation="3"></feGaussianBlur>
				</filter>
			</defs>
		</svg>
   </head>
   <body>
        <div class="content">
		<div class="chat-list">
			<div class="topBar">
			<div id="title">
				EVE - Datingassistance
			</div>
			<div id="username">
				{{.User.Name}} (Logout)
			</div>
			<div id="newBot">
                <button id="newBotButton" onclick="showPopup('popup')" value=""></button>
			</div>
			</div>
			
        {{if .ActiveBot}}
            <div class="bot-list"><ul>
            {{range $bot := .Bots}}
                <li class="bot" id="{{if eq $.ActiveBot.ID $bot.ID}}bot-active{{end}}" botID="{{$bot.ID}}">
                    <a href="/?bot={{$bot.ID}}"><img src="{{$bot.Image}}"> {{$bot.Name}}</a>
                </li>
            {{end}}
        {{end}}
            </ul></div>
        </div>
        {{if .ActiveBot}}
        <div class="chat">
            <div class="topBar2">
			<img src="{{.ActiveBot.Image}}" onclick="showPopup('profilepopup')">
            <div id="botname">Chatting with: <b style="cursor:pointer;" onclick="showPopup('profilepopup')">{{.ActiveBot.Name}}</b></div>
			</div>
            <div id="log">
                {{range $msg := .Messages}}
                <p class="msg {{if eq $msg.Sender 1}}user{{else}}bot{{end}}">
                    {{$msg.Content}}
                        <span class="timestamp">{{time $msg.Timestamp}}</span>
                </p>
                {{end}}
            </div>
            <form id="form" autocomplete="off">
                <textarea id="msg" maxlength="200"></textarea>
                <input type="submit" value="" id="send"/>
            </form>
        </div>
		</div>
		
        {{end}}
		
		<!-- Bot creation popup -->
		<div id="popup">
		<!--<h1>New chat.</h1>-->
		<div id="hidePopupButton"><button onclick="hidePopup('popup')"></button></div>
				<br /><div class="newbotdesc">Click on the picture to change your partner.</div><br /><br />
				<button id="imageinput" onclick="showChangeImagePopup()" value=""></button>
				
				<br /><p id="generatedName">Name<button onclick="genName()"></button></p>
				
				<div class="switch-field"><input type="radio" id="switch_left" name="gender" value="f" onclick="onSexChange()" checked />
				<label for="switch_left">Female</label>
				<input type="radio" id="switch_right" name="gender" value="m" onclick="onSexChange()" />
				<label for="switch_right">Male</label></div><br />
				
                <br /><button class="button" onclick="submitBotCreation()">Let's go!</button>
		</div>
		
		<!-- Bot image selection popup -->
		<div id="imagepopup">
		<div id="hidePopupButton"><button onclick="hidePopup('imagepopup'); showPopup('popup');" style="background-image: url('/static/back-128.png');"></button></div><br />
				<div id="imagepopupcontainer">
				<!-- Content added by JS -->
				</div>
		</div>
		
		<div id="profilepopup">
		{{if .ActiveBot}}
		<div id="hidePopupButton"><button onclick="hidePopup('profilepopup')"></button></div><br />
		<img id="profileimage" src="{{.ActiveBot.Image}}"/>
		<br /><p id="profilename">{{.ActiveBot.Name}}({{years .ActiveBot.Birthdate}})</p>
		{{end}}
		</div>
		
		<div id="invisibleDismissContainer"></div>
		
   </body>
</html>